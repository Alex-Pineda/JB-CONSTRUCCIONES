<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gestión de Proyectos</title>
  <link rel="icon" href="../assets/img/favicon.ico" type="image/x-icon" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../assets/css/style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(135deg, #e8eaf6 0%, #f4f5f7 100%);
    }
  </style>

</head>

<body class="text-gray-800">
  <div class="flex flex-col min-h-screen bg-transparent">

    <!-- ENCABEZADO -->
    <header class="bg-transparent border-b-[3px] border-[#161a7e] py-4 px-6 shadow-sm flex justify-between items-center">
      <h1 class="text-xl font-semibold text-gray-700">Gestión Proyectos</h1>
      <div class="flex gap-2">
        <button 
          onclick="window.location.href='../index.html'" 
          class="px-2 py-1 bg-yellow-500 text-white rounded-md hover:bg-yellow-600 transition">
          Inicio
        </button>
      </div>
    </header>

    <!-- FILTROS DE BÚSQUEDA -->
    <div class="flex flex-col sm:flex-row gap-3 mt-6 mb-6 items-center justify-center sm:justify-between px-4">
      
      <!-- Barra de búsqueda -->
      <input id="buscarProyecto" 
        type="text" 
        placeholder="Buscar por nombre del proyecto..." 
        class="w-full sm:w-1/2 border border-[#161a7e]/40 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#161a7e]">

      <!-- Lista desplegable -->
      <select id="estadoProyecto" 
        class="w-full sm:w-1/3 border border-[#161a7e]/40 rounded-lg px-3 py-2 bg-white focus:outline-none focus:ring-2 focus:ring-[#161a7e]">
        <option value="">Todos los estados</option>
        <option value="progreso">En progreso</option>
        <option value="pausa">En pausa</option>
        <option value="finalizado">Finalizado</option>
      </select>

      <!-- Botones -->
      <div class="flex gap-2 mt-4 sm:mt-0 items-center justify-center sm:justify-end">
        <button onclick="window.location.href='nuevoProyecto.html'" class="px-2 py-1 bg-green-600 text-white rounded-md hover:bg-green-900 transition">Agregar</button>
        <button class="px-3 py-1 bg-gray-600 text-white rounded-md hover:bg-gray-900 transition">Exportar</button>
      </div>
    </div>


<!-- LISTA DE PROYECTOS (EN TARJETAS) -->
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4 gap-4 justify-items-center px-4 py-6">

  <!-- TARJETA 1 -->
  <div class="border border-[#161a7e]/40 rounded-xl bg-white/80 p-3 shadow-md hover:shadow-lg transition max-w-[480px] w-full mx-auto">
    <div class="flex flex-col justify-between h-full">
      <!-- ENCABEZADO -->
      <div class="flex justify-between items-center border-b pb-2 mb-3">
        <h3 class="text-base font-semibold text-[#161a7e] truncate">Reforma parque</h3>
        <span class="text-[11px] bg-green-100 text-green-700 px-2 py-[2px] rounded-full border border-green-300 font-medium">
          En progreso
        </span>
      </div>

      <!-- DETALLES -->
      <div class="text-xs space-y-1">
        <div class="flex justify-between items-center">
          <p><strong>Cliente:</strong> Juan Bustamante</p>
          <a href="https://wa.me/573007413114" target="_blank" class="flex items-center justify-center">
            <img src="../assets/img/whatsapp-fill.svg" alt="WhatsApp"
                 class="w-7 h-7 transition-transform duration-200 hover:scale-125 hover:brightness-125"/>
          </a>
        </div>
        <p><strong>Contacto:</strong> +57 3216549870</p>
        <p><strong>Correo:</strong> juanbusta@gmail.com</p>
        <p><strong>Dirección:</strong>
          <a href="#" onclick="mostrarMapa('Parque principal Sopetrán, Antioquia')" 
             class="text-blue-600 hover:underline">
             Parque principal Sopetrán, Antioquia
          </a>
        </p>
        <p><strong>Inicio:</strong> 15/10/2025</p>
        <p><strong>Final (Aprox):</strong> 15/12/2026</p>
      </div>

      <!-- BOTONES -->
      <div class="mt-3 flex flex-wrap gap-2 justify-between">
        <button onclick="abrirContrato('Reforma parque', 'Juan Bustamante')" 
                class="flex-1 bg-blue-600 text-white rounded-md py-1 text-[11px] hover:bg-blue-800 transition">
          Ver Contrato
        </button>
        <button onclick="window.location.href='progresoObra.html'"
                class="flex-1 bg-[#161a7e] text-white rounded-md py-1 text-[11px] hover:bg-[#0f1368] transition">
          Evidencias
        </button>
      </div>
    </div>
  </div>

  <!-- TARJETA 2 -->
  <div class="border border-[#161a7e]/40 rounded-xl bg-white/80 p-3 shadow-md hover:shadow-lg transition max-w-[480px] w-full mx-auto">
    <div class="flex flex-col justify-between h-full">
      <div class="flex justify-between items-center border-b pb-2 mb-3">
        <h3 class="text-base font-semibold text-[#161a7e] truncate">Construcción local comercial</h3>
        <span class="text-[11px] bg-yellow-100 text-yellow-700 px-2 py-[2px] rounded-full border border-yellow-300 font-medium">
          En pausa
        </span>
      </div>
      <div class="text-xs space-y-1">
        <div class="flex justify-between items-center">
          <p><strong>Cliente:</strong> María López</p>
          <a href="https://wa.me/573007413114" target="_blank" class="flex items-center justify-center">
            <img src="../assets/img/whatsapp-fill.svg" alt="WhatsApp"
                 class="w-7 h-7 transition-transform duration-200 hover:scale-125 hover:brightness-125"/>
          </a>
        </div>
        <p><strong>Contacto:</strong> +57 3224567890</p>
        <p><strong>Correo:</strong> marialopez@gmail.com</p>
        <p><strong>Dirección:</strong>
          <a href="#" onclick="mostrarMapa('Carrera 12 #45-23 Medellín')" 
             class="text-blue-600 hover:underline">
             Carrera 12 #45-23 Medellín
          </a>
        </p>
        <p><strong>Inicio:</strong> 01/03/2025</p>
        <p><strong>Final (Aprox):</strong> 20/11/2025</p>
      </div>
      <div class="mt-3 flex flex-wrap gap-2 justify-between">
        <button onclick="abrirContrato('Construcción local comercial', 'María López')" 
                class="flex-1 bg-blue-600 text-white rounded-md py-1 text-[11px] hover:bg-blue-800 transition">
          Ver Contrato
        </button>
        <button onclick="window.location.href='progresoObra.html'"
                class="flex-1 bg-[#161a7e] text-white rounded-md py-1 text-[11px] hover:bg-[#0f1368] transition">
          Evidencias
        </button>
      </div>
    </div>
  </div>

  <!-- TARJETA 3 -->
  <div class="border border-[#161a7e]/40 rounded-xl bg-white/80 p-3 shadow-md hover:shadow-lg transition max-w-[480px] w-full mx-auto">
    <div class="flex flex-col justify-between h-full">
      <div class="flex justify-between items-center border-b pb-2 mb-3">
        <h3 class="text-base font-semibold text-[#161a7e] truncate">Remodelación vivienda rural</h3>
        <span class="text-[11px] bg-blue-100 text-blue-700 px-2 py-[2px] rounded-full border border-blue-300 font-medium">
          Finalizado
        </span>
      </div>
      <div class="text-xs space-y-1">
        <div class="flex justify-between items-center">
          <p><strong>Cliente:</strong> Carlos Mejía</p>
          <a href="https://wa.me/573007413114" target="_blank" class="flex items-center justify-center">
            <img src="../assets/img/whatsapp-fill.svg" alt="WhatsApp"
                 class="w-7 h-7 transition-transform duration-200 hover:scale-125 hover:brightness-125"/>
          </a>
        </div>
        <p><strong>Contacto:</strong> +57 3145698700</p>
        <p><strong>Correo:</strong> carlosmj@gmail.com</p>
        <p><strong>Dirección:</strong>
          <a href="#" onclick="mostrarMapa('Vereda El Salado, Sopetrán')" 
             class="text-blue-600 hover:underline">
             Vereda El Salado, Sopetrán
          </a>
        </p>
        <p><strong>Inicio:</strong> 10/01/2025</p>
        <p><strong>Final:</strong> 20/04/2025</p>
      </div>
      <div class="mt-3 flex flex-wrap gap-2 justify-between">
        <button onclick="abrirContrato('Remodelación vivienda rural', 'Carlos Mejía')" 
                class="flex-1 bg-blue-600 text-white rounded-md py-1 text-[11px] hover:bg-blue-800 transition">
          Ver Contrato
        </button>
        <button onclick="window.location.href='progresoObra.html'"
                class="flex-1 bg-[#161a7e] text-white rounded-md py-1 text-[11px] hover:bg-[#0f1368] transition">
          Evidencias
        </button>
      </div>
    </div>
  </div>

  <!-- TARJETA 4 -->
  <div class="border border-[#161a7e]/40 rounded-xl bg-white/80 p-3 shadow-md hover:shadow-lg transition max-w-[480px] w-full mx-auto">
    <div class="flex flex-col justify-between h-full">
      <div class="flex justify-between items-center border-b pb-2 mb-3">
        <h3 class="text-base font-semibold text-[#161a7e] truncate">Reforma parque</h3>
        <span class="text-[11px] bg-green-100 text-green-700 px-2 py-[2px] rounded-full border border-green-300 font-medium">
          En progreso
        </span>
      </div>
      <div class="text-xs space-y-1">
        <div class="flex justify-between items-center">
          <p><strong>Cliente:</strong> Juan Bustamante</p>
          <a href="https://wa.me/573007413114" target="_blank" class="flex items-center justify-center">
            <img src="../assets/img/whatsapp-fill.svg" alt="WhatsApp"
                 class="w-7 h-7 transition-transform duration-200 hover:scale-125 hover:brightness-125"/>
          </a>
        </div>
        <p><strong>Contacto:</strong> +57 3216549870</p>
        <p><strong>Correo:</strong> juanbusta@gmail.com</p>
        <p><strong>Dirección:</strong>
          <a href="#" onclick="mostrarMapa('Carrera 65A # 93-90 Medellín, Antioquia')" 
             class="text-blue-600 hover:underline">
             Carrera 65A # 93-90 Medellín, Antioquia
          </a>
        </p>
        <p><strong>Inicio:</strong> 15/10/2025</p>
        <p><strong>Final (Aprox):</strong> 15/12/2026</p>
      </div>
      <div class="mt-3 flex flex-wrap gap-2 justify-between">
        <button onclick="abrirContrato('Reforma parque', 'Juan Bustamante')" 
                class="flex-1 bg-blue-600 text-white rounded-md py-1 text-[11px] hover:bg-blue-800 transition">
          Ver Contrato
        </button>
        <button onclick="window.location.href='progresoObra.html'"
                class="flex-1 bg-[#161a7e] text-white rounded-md py-1 text-[11px] hover:bg-[#0f1368] transition">
          Evidencias
        </button>
      </div>
    </div>
  </div>
</div>

<!-- MODAL MAPA -->
<div id="mapaModal" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50">
  <div class="bg-white rounded-2xl shadow-2xl w-[90%] max-w-3xl p-6 relative">
    <button onclick="cerrarMapa()" class="absolute top-2 right-3 text-red-600 text-lg font-bold">✖</button>
    <h2 class="text-xl font-semibold text-center text-gray-800 mb-4">Ubicación del Proyecto</h2>
    <iframe id="mapaFrame" class="w-full h-96 rounded-lg border" frameborder="0" allowfullscreen></iframe>
    <div class="text-center mt-4">
      <a id="verEnGoogleMaps" href="#" target="_blank" 
         class="inline-block px-4 py-2 bg-[#161a7e] text-white rounded-md hover:bg-[#0f1368] transition">
         Ver en Google Maps
      </a>
    </div>  
  </div>
</div>

  <!-- MODAL CONTRATO -->
  <div id="modalContrato" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
    <div class="bg-white rounded-2xl shadow-2xl w-[90%] max-w-3xl p-6 relative">
      <button onclick="cerrarContrato()" class="absolute top-2 right-3 text-red-600 text-lg font-bold">✖</button>
      <h2 class="text-xl font-semibold text-center text-gray-800 mb-4">Contrato del Proyecto</h2>
      <div id="contenidoContrato" class="max-h-96 overflow-y-auto text-sm text-gray-700"></div>
      <div class="mt-6 flex justify-center gap-4">
        <button onclick="firmarContrato()" class="bg-green-600 text-white rounded-md px-4 py-2 hover:bg-green-800 transition">
          Firmar Contrato
        </button>
        <button onclick="descargarContratoPDF()" class="bg-blue-600 text-white rounded-md px-4 py-2 hover:bg-blue-800 transition">
          Descargar PDF
        </button>
      </div> 
    </div>
  </div>


    <script>
      function mostrarMapa(direccion) {
        const mapaModal = document.getElementById('mapaModal');
        const mapaFrame = document.getElementById('mapaFrame');
        const enlace = document.getElementById('verEnGoogleMaps');

        const direccionCodificada = encodeURIComponent(direccion);
        const url = `https://www.google.com/maps?q=${direccionCodificada}&output=embed`;
        const enlaceMaps = `https://www.google.com/maps/dir/?api=1&destination=${direccionCodificada}`;

        mapaFrame.src = url;
        enlace.href = enlaceMaps;

        mapaModal.classList.remove('hidden');
      }

      function cerrarMapa() {
        document.getElementById('mapaModal').classList.add('hidden');
        document.getElementById('mapaFrame').src = "";
      }
      function abrirContrato(nombreProyecto, cliente) {
        
      const contrato = `
        <p>Entre <strong>JB CONSTRUCCIONES</strong>, en adelante <strong>“La Empresa”</strong>, 
        y <strong>${cliente}</strong>, identificado como Cliente, se celebra el presente contrato
        para la ejecución del proyecto denominado <strong>${nombreProyecto}</strong>.</p>

        <p><strong>Cláusulas principales:</strong></p>
        <ol class="list-decimal ml-5 space-y-1">
          <li>El proyecto se realizará conforme al cronograma y planos aprobados.</li>
          <li>El cliente se compromete a cumplir con los pagos establecidos en el acuerdo.</li>
          <li>La empresa garantiza calidad y cumplimiento en la ejecución.</li>
          <li>Ambas partes acuerdan resolver controversias de forma amistosa.</li>
        </ol>

        <p class="mt-4">Firmado electrónicamente el <strong>${new Date().toLocaleDateString()}</strong>.</p>
      `;

      document.getElementById("contenidoContrato").innerHTML = contrato;
      document.getElementById("modalContrato").classList.remove("hidden");
    }

    function cerrarContrato() {
      document.getElementById("modalContrato").classList.add("hidden");
    }

    function firmarContrato() {
      alert("✅ Contrato firmado electrónicamente. Se guardará en tu registro de usuario.");
      cerrarContrato();
    }

    function descargarContratoPDF() {
      const contenido = document.getElementById("contenidoContrato").innerText;
      const blob = new Blob([contenido], { type: "text/plain;charset=utf-8" });
      const enlace = document.createElement("a");
      enlace.href = URL.createObjectURL(blob);
      enlace.download = "Contrato_Proyecto.txt";
      enlace.click();
    }

    function actualizarBadgeEstado(estado) {
    const badge = document.getElementById("badgeEstado");
    
    // Reinicia clases
    badge.className = "inline-block px-2 py-1 rounded-full border font-medium text-xs";
    
    // Cambia colores según el estado
    switch (estado.toLowerCase()) {
      case "en progreso":
        badge.textContent = "En progreso";
        badge.classList.add("bg-green-100", "text-green-700", "border-green-400");
        break;
      case "en pausa":
        badge.textContent = "En pausa";
        badge.classList.add("bg-yellow-100", "text-yellow-700", "border-yellow-400");
        break;
      case "finalizado":
        badge.textContent = "Finalizado";
        badge.classList.add("bg-blue-100", "text-blue-700", "border-blue-400");
        break;
      default:
        badge.textContent = "Desconocido";
        badge.classList.add("bg-gray-100", "text-gray-700", "border-gray-400");
    }
  }

  // Ejemplo de uso:
  actualizarBadgeEstado("en progreso"); // Puedes cambiar a "en pausa" o "finalizado"

    </script>

    <script src="../Scripts/main.js"></script>
  </body>
</html>
